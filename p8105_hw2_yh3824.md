Homework 2
================
ruby
2025-09-26

## Problem 1

Install libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

Upload and clean pols-month.csv dataset

``` r
pols_df = 
  read_csv("fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon,into = c("year", "month", "day"), sep = "-", convert = TRUE) |> 
  mutate(month = month.name[month], president = prez_dem, prez_gop ) |>   
  select(-day, -prez_dem, - prez_gop)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

upload and clean snp.csv dataset

``` r
snp_df = 
  read_csv("fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/", convert = TRUE) |>
  select(year, month, everything()) |> 
  mutate(month = month.name[month], 
         year = ifelse(year < 30, year + 2000, year + 1900)
         )
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

upload and clean unemployment.csv

``` r
unemploy_df = 
  read_csv("fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(jan:dec, 
               names_to = "month", 
               values_to = "unemployment %") |> 
  mutate(month = month.name[match(tolower(month), tolower(month.abb))])
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging snp into pols, and merging unemployment
into the result. (NEED TO COME BACK HERE TO SEE WHAT KIND OF JOIN TO
USE)

``` r
prob1_df =
  left_join(snp_df, pols_df, by = "year")
```

    ## Warning in left_join(snp_df, pols_df, by = "year"): Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 817 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

## Problem 2

import and clean mr trash wheel dataset

``` r
mrtrash_df = 
  read_excel("202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel", 
             skip = 1, n_max = 651) |> 
  janitor::clean_names() |>  
  janitor::remove_empty(which = "cols") |> 
  mutate(sports_balls = as.integer(round(sports_balls)))
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

import and clean professor trash wheel dataset

``` r
proftrash_df = 
  read_excel("202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel", 
             skip = 1,  n_max = 118) |> 
  janitor::clean_names()
```

import and clean gwynnda trash wheel dataset

``` r
gwynnda_df = 
  read_excel("202409 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel", 
             skip = 1, n_max = 263) |> 
  janitor::clean_names()
```

combine datasets

``` r
fulltrash_df = 
  left_join(mrtrash_df, proftrash_df, gwynnda_df, by = "dumpster")
```

## Problem 3

import zip code data

``` r
zipcode_df = 
  read_csv("zillow_data/Zip Codes.csv") |> 
  janitor::clean_names() |> 
  mutate(zip_code = as.integer(zip_code)) |> 
  select(-state_fips, - county_code, -county_fips)
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zori_df =
  read_csv("zillow_data/Zip_Zori_uc_sfrcondomfr_sm_month_NYC.csv") |> 
  janitor::clean_names() |> 
  mutate(zip_code = as.integer(region_name)) |> 
  pivot_longer(x2015_01_31:x2024_08_31, 
               names_to = "date", 
               values_to = "rent") |> 
  select(-size_rank, -metro, -region_id, -region_name, -region_type, -state_name, -state, -city) |> 
  mutate(county_name = str_remove(county_name, 
                                  regex(" county$", ignore_case = TRUE))) |> 
  rename(county = county_name) 
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
glimpse(zipcode_df)
```

    ## Rows: 322
    ## Columns: 4
    ## $ county       <chr> "Bronx", "Bronx", "Bronx", "Bronx", "Bronx", "Bronx", "Br…
    ## $ zip_code     <int> 10451, 10452, 10453, 10454, 10455, 10456, 10457, 10458, 1…
    ## $ file_date    <chr> "7/25/07", "7/25/07", "7/25/07", "7/25/07", "7/25/07", "7…
    ## $ neighborhood <chr> "High Bridge and Morrisania", "High Bridge and Morrisania…

Arrange both datasets to have zip code, county in the first columns

``` r
zipcode_df |> 
  select(zip_code, county, neighborhood, everything())
```

    ## # A tibble: 322 × 4
    ##    zip_code county neighborhood               file_date
    ##       <int> <chr>  <chr>                      <chr>    
    ##  1    10451 Bronx  High Bridge and Morrisania 7/25/07  
    ##  2    10452 Bronx  High Bridge and Morrisania 7/25/07  
    ##  3    10453 Bronx  Central Bronx              7/25/07  
    ##  4    10454 Bronx  Hunts Point and Mott Haven 7/25/07  
    ##  5    10455 Bronx  Hunts Point and Mott Haven 7/25/07  
    ##  6    10456 Bronx  High Bridge and Morrisania 7/25/07  
    ##  7    10457 Bronx  Central Bronx              7/25/07  
    ##  8    10458 Bronx  Bronx Park and Fordham     7/25/07  
    ##  9    10459 Bronx  Hunts Point and Mott Haven 7/25/07  
    ## 10    10460 Bronx  Central Bronx              7/25/07  
    ## # ℹ 312 more rows

``` r
zori_df |> 
  select(zip_code, county, date, rent, everything())
```

    ## # A tibble: 17,284 × 4
    ##    zip_code county date         rent
    ##       <int> <chr>  <chr>       <dbl>
    ##  1    11368 Queens x2015_01_31    NA
    ##  2    11368 Queens x2015_02_28    NA
    ##  3    11368 Queens x2015_03_31    NA
    ##  4    11368 Queens x2015_04_30    NA
    ##  5    11368 Queens x2015_05_31    NA
    ##  6    11368 Queens x2015_06_30    NA
    ##  7    11368 Queens x2015_07_31    NA
    ##  8    11368 Queens x2015_08_31    NA
    ##  9    11368 Queens x2015_09_30    NA
    ## 10    11368 Queens x2015_10_31    NA
    ## # ℹ 17,274 more rows

combine datasets

``` r
tidy_zillow = 
  full_join(zipcode_df, zori_df, by = "zip_code")
```

    ## Warning in full_join(zipcode_df, zori_df, by = "zip_code"): Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 1 of `x` matches multiple rows in `y`.
    ## ℹ Row 4757 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.
